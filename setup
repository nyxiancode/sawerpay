#!/bin/bash

# Install atau upgrade dependencies dari requirements.txt
echo "Menginstal atau mengupgrade dependencies..."
pip install --upgrade -r requirements.txt

# Memeriksa apakah file sample.env sudah ada
if [ ! -f sample.env ]; then
    echo "File sample.env tidak ditemukan. Pastikan file tersebut ada di direktori ini."
    exit 1
fi

# Membaca input pengguna untuk mengisi .env
echo "Mengisi konfigurasi .env..."
touch .env  # Membuat file .env jika belum ada

# Loop melalui setiap baris di sample.env
while IFS= read -r line; do
    # Skip baris kosong atau komentar
    if [[ -z "$line" || "$line" == \#* ]]; then
        echo "$line" >> .env
        continue
    fi

    # Ekstrak key dari baris
    key=$(echo "$line" | cut -d '=' -f 1)
    default_value=$(echo "$line" | cut -d '=' -f 2)

    # Meminta input pengguna
    read -p "Masukkan nilai untuk $key (default: $default_value): " user_value

    # Jika pengguna tidak memasukkan nilai, gunakan nilai default
    if [ -z "$user_value" ]; then
        user_value="$default_value"
    fi

    # Menulis ke file .env
    echo "$key=$user_value" >> .env
done < sample.env

echo "Setup selesai. File .env telah dibuat."
